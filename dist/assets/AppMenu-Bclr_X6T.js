import{a9 as G,b as U,r as u,j as s,g as x,I as S,L as _}from"./index-AWqnUruu.js";import{g as q,f as P,a as $}from"./index-CsXuet0Y.js";import{C as D}from"./Collapse-KMTEkdMi.js";import"./LogoBox-CGjn2tYH.js";import"./logo-light-ClDG_0_V.js";import"./logo-sm-DRF7g9KH.js";import"./SimplebarReactClient-Cc2JzDYg.js";import"./useViewPort-CIhlKKrv.js";const J={dashboards:"dashboard.view","dashboard-admin":"dashboard.view",management:"management.view","management-departments":"management.departments","management-sections":"management.sections","management-employees":"management.employees","management-users":"management.users","management-permissions":"management.permissions",support:"support.tickets","support-tickets":"support.tickets","support-followups":"support.followups","support-reviews":"support.reviews",operations:"operations.view","operations-all":"operations.view","operations-mine":"operations.view","operations-calendar":"operations.calendar","operations-notifications":"operations.notifications",content:"content.ideas","content-ideas":"content.ideas","content-scripts":"content.scripts","content-production-editing":"content.production","content-social":"content.social","content-library":"content.library",reports:"reports.support","reports-support-kpis":"reports.support","reports-content-kpis":"reports.content","reports-operations":"reports.operations","reports-custom":"reports.custom",settings:"settings.profile","settings-profile":"settings.profile","settings-system":"settings.system","settings-access":"settings.access.manage"},E={support:["support.tickets","support.followups","support.reviews"],content:["content.ideas","content.scripts","content.production","content.social","content.library"],reports:["reports.support","reports.content","reports.operations","reports.custom"]};function B(e,o){if(!o||o.length===0)return[];const d=c=>{if(E[c])return E[c].some(r=>o.includes(r));const t=J[c];return t?o.includes(t):!0},g=c=>c.reduce((t,r)=>{if(r.isTitle)return t.push(r),t;if(!d(r.key))return t;if(r.children&&r.children.length>0){const p=g(r.children);p.length>0&&t.push({...r,children:p})}else t.push(r);return t},[]);return g(e).filter((c,t,r)=>{if(!c.isTitle)return!0;for(let p=t+1;p<r.length;p++){if(!r[p].isTitle)return!0;if(r[p].isTitle)break}return!1})}const I=({item:e,className:o,linkClassName:d,subMenuClassName:g,activeMenuItems:a,toggleMenu:c,openGroups:t})=>{const[r,p]=u.useState(a.includes(e.key)||t.includes(e.key));u.useEffect(()=>{p(a.includes(e.key)||t.includes(e.key))},[a,e,t]);const N=l=>{l.preventDefault();const k=!r;return p(k),c&&c(e,k),!1},v=u.useCallback(l=>a!=null&&a.includes(l.key)?"active":"",[a]);return s.jsxs("li",{className:o,children:[s.jsxs("div",{onClick:N,"aria-expanded":r,role:"button",className:x(d),children:[e.icon&&s.jsx("span",{className:"nav-icon",children:s.jsx(S,{icon:e.icon})}),s.jsx("span",{className:"nav-text",children:e.label}),e.badge?s.jsx("span",{className:`badge badge-pill text-end bg-${e.badge.variant}`,children:e.badge.text}):s.jsx(S,{icon:"bx:chevron-down",className:"menu-arrow"})]}),s.jsx(D,{in:r,children:s.jsx("div",{children:s.jsx("ul",{className:x(g),children:(e.children||[]).map((l,k)=>s.jsx(u.Fragment,{children:l.children?s.jsx(I,{item:l,linkClassName:x("nav-link",v(l)),activeMenuItems:a,className:"sub-nav-item",subMenuClassName:"nav sub-navbar-nav",toggleMenu:c,openGroups:t}):s.jsx(M,{item:l,className:"sub-nav-item",linkClassName:x("sub-nav-link",v(l))})},l.key+k))})})})]})},M=({item:e,className:o,linkClassName:d})=>s.jsx("li",{className:o,children:s.jsx(H,{item:e,className:d})}),H=({item:e,className:o})=>s.jsxs(_,{to:e.url??"",target:e.target,className:x(o,{disabled:e.isDisabled}),children:[e.icon&&s.jsx("span",{className:"nav-icon",children:s.jsx(S,{icon:e.icon})}),s.jsx("span",{className:"nav-text",children:e.label}),e.badge&&s.jsx("span",{className:`badge badge-pill text-end bg-${e.badge.variant}`,children:e.badge.text})]}),ee=({menuItems:e})=>{const{pathname:o}=G(),{permissions:d,isAuthenticated:g}=U(),[a,c]=u.useState([]),t=u.useMemo(()=>!g||!d?[]:B(e,d),[e,d,g]),r="sidebar.openGroups",p=()=>{try{const n=localStorage.getItem(r);return n?JSON.parse(n):[]}catch(n){return console.warn("Failed to load sidebar state from localStorage:",n),[]}},N=n=>{try{localStorage.setItem(r,JSON.stringify(n))}catch(f){console.warn("Failed to save sidebar state to localStorage:",f)}},[v,l]=u.useState(p),k=(n,f)=>{if(f){const m=[...new Set([...v,n.key])];l(m),N(m)}else{const m=v.filter(y=>y!==n.key);l(m),N(m)}},C=u.useCallback(n=>a!=null&&a.includes(n.key)?"active":"",[a]),T=u.useCallback(()=>{const n=o==null?void 0:o.replaceAll("",""),f=q(t,n);if(f){const m=P(e,f.key);if(m){const i=[m.key,...$(e,m)];c(i)}setTimeout(()=>{const i=document.querySelector(`#leftside-menu-container .simplebar-content a[href="${n}"]`);if(i){const b=document.querySelector("#leftside-menu-container .simplebar-content-wrapper");if(b){const h=i.offsetTop-window.innerHeight*.4;L(b,h,600)}}},400);const y=(i,b,h,j)=>(i/=j/2,i<1?h/2*i*i+b:(i--,-h/2*(i*(i-2)-1)+b)),L=(i,b,h)=>{const j=i.scrollTop,F=b-j,O=20;let w=0;const A=function(){w+=O;const R=y(w,j,F,h);i.scrollTop=R,w<h&&setTimeout(A,O)};A()}}},[o,e]);return u.useEffect(()=>{t&&t.length>0&&T()},[T,t]),s.jsx("ul",{className:"navbar-nav",children:(t||[]).map((n,f)=>s.jsx(u.Fragment,{children:n.isTitle?s.jsx("li",{className:"menu-title",children:n.label}):s.jsx(s.Fragment,{children:n.children?s.jsx(I,{item:n,toggleMenu:k,className:"nav-item",linkClassName:x("nav-link",C(n)),subMenuClassName:"nav sub-navbar-nav",activeMenuItems:a,openGroups:v}):s.jsx(M,{item:n,linkClassName:x("nav-link",C(n)),className:"nav-item"})})},n.key+f))})};export{ee as default};
