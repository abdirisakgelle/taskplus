import{ab as G,e as U,r as d,j as s,k,I as S,L as _}from"./index-g8JsAD6D.js";import{g as q,f as $,a as D}from"./index-2gXObV8w.js";import{C as J}from"./Collapse-CiHPaFiN.js";import"./LogoBox-D9c4dI6R.js";import"./SimplebarReactClient-CNHEd7-e.js";import"./useViewPort-C2IbuYb2.js";const P={dashboards:"dashboard.view","dashboard-admin":"dashboard.view",management:"management.view","management-departments":"management.departments","management-sections":"management.sections","management-employees":"management.employees","management-users":"management.users","management-permissions":"management.permissions",support:"support.tickets","support-tickets":"support.tickets","support-followups":"support.followups","support-reviews":"support.reviews",operations:"tasks.view","operations-all":"tasks.view","operations-mine":"tasks.mine","operations-calendar":"operations.calendar","operations-notifications":"operations.notifications",content:"content.ideas","content-ideas":"content.ideas","content-scripts":"content.scripts","content-production-editing":"content.production","content-social":"content.social","content-library":"content.library",reports:"reports.support","reports-support-kpis":"reports.support","reports-content-kpis":"reports.content","reports-operations":"reports.operations","reports-custom":"reports.custom",settings:"settings.profile","settings-profile":"settings.profile","settings-system":"settings.system","settings-access":"settings.access.manage"},E={support:["support.tickets","support.followups","support.reviews"],operations:["tasks.view","tasks.mine","operations.calendar","operations.notifications"],content:["content.ideas","content.scripts","content.production","content.social","content.library"],reports:["reports.support","reports.content","reports.operations","reports.custom"]};function B(e,o){if(!o||!Array.isArray(o)||o.length===0)return[];const g=l=>{if(E[l])return E[l].some(r=>o.includes(r));const t=P[l];return t?o.includes(t):!0},f=l=>l.reduce((t,r)=>{if(r.isTitle)return t.push(r),t;if(!g(r.key))return t;if(r.children&&r.children.length>0){const p=f(r.children);p.length>0&&t.push({...r,children:p})}else t.push(r);return t},[]);return f(e).filter((l,t,r)=>{if(!l.isTitle)return!0;for(let p=t+1;p<r.length;p++){if(!r[p].isTitle)return!0;if(r[p].isTitle)break}return!1})}const M=({item:e,className:o,linkClassName:g,subMenuClassName:f,activeMenuItems:a,toggleMenu:l,openGroups:t})=>{const[r,p]=d.useState(a.includes(e.key)||t.includes(e.key));d.useEffect(()=>{p(a.includes(e.key)||t.includes(e.key))},[a,e,t]);const y=c=>{c.preventDefault();const v=!r;return p(v),l&&l(e,v),!1},x=d.useCallback(c=>a!=null&&a.includes(c.key)?"active":"",[a]);return s.jsxs("li",{className:o,children:[s.jsxs("div",{onClick:y,"aria-expanded":r,role:"button",className:k(g),children:[e.icon&&s.jsx("span",{className:"nav-icon",children:s.jsx(S,{icon:e.icon})}),s.jsx("span",{className:"nav-text",children:e.label}),e.badge?s.jsx("span",{className:`badge badge-pill text-end bg-${e.badge.variant}`,children:e.badge.text}):s.jsx(S,{icon:"bx:chevron-down",className:"menu-arrow"})]}),s.jsx(J,{in:r,children:s.jsx("div",{children:s.jsx("ul",{className:k(f),children:(e.children||[]).map((c,v)=>s.jsx(d.Fragment,{children:c.children?s.jsx(M,{item:c,linkClassName:k("nav-link",x(c)),activeMenuItems:a,className:"sub-nav-item",subMenuClassName:"nav sub-navbar-nav",toggleMenu:l,openGroups:t}):s.jsx(I,{item:c,className:"sub-nav-item",linkClassName:k("sub-nav-link",x(c))})},c.key+v))})})})]})},I=({item:e,className:o,linkClassName:g})=>s.jsx("li",{className:o,children:s.jsx(H,{item:e,className:g})}),H=({item:e,className:o})=>s.jsxs(_,{to:e.url??"",target:e.target,className:k(o,{disabled:e.isDisabled}),children:[e.icon&&s.jsx("span",{className:"nav-icon",children:s.jsx(S,{icon:e.icon})}),s.jsx("span",{className:"nav-text",children:e.label}),e.badge&&s.jsx("span",{className:`badge badge-pill text-end bg-${e.badge.variant}`,children:e.badge.text})]}),X=({menuItems:e})=>{const{pathname:o}=G(),{permissions:g,isAuthenticated:f}=U(),[a,l]=d.useState([]),t=d.useMemo(()=>{if(!f||!g||!Array.isArray(g))return[];try{return B(e,g)}catch(n){return console.error("Error filtering menu items:",n),[]}},[e,g,f]),r="sidebar.openGroups",p=()=>{try{const n=localStorage.getItem(r);return n?JSON.parse(n):[]}catch(n){return console.warn("Failed to load sidebar state from localStorage:",n),[]}},y=n=>{try{localStorage.setItem(r,JSON.stringify(n))}catch(m){console.warn("Failed to save sidebar state to localStorage:",m)}},[x,c]=d.useState(p),v=(n,m)=>{if(console.log("Toggle menu:",n.key,m),m){const u=[...new Set([...x,n.key])];c(u),y(u),console.log("Opening menu, new groups:",u)}else{const u=x.filter(j=>j!==n.key);c(u),y(u),console.log("Closing menu, new groups:",u)}},C=d.useCallback(n=>a!=null&&a.includes(n.key)?"active":"",[a]),T=d.useCallback(()=>{const n=o==null?void 0:o.replaceAll("",""),m=q(t,n);if(m){const u=$(e,m.key);if(u){const i=[u.key,...D(e,u)];l(i)}setTimeout(()=>{const i=document.querySelector(`#leftside-menu-container .simplebar-content a[href="${n}"]`);if(i){const b=document.querySelector("#leftside-menu-container .simplebar-content-wrapper");if(b){const h=i.offsetTop-window.innerHeight*.4;L(b,h,600)}}},400);const j=(i,b,h,N)=>(i/=N/2,i<1?h/2*i*i+b:(i--,-h/2*(i*(i-2)-1)+b)),L=(i,b,h)=>{const N=i.scrollTop,F=b-N,A=20;let w=0;const O=function(){w+=A;const R=j(w,N,F,h);i.scrollTop=R,w<h&&setTimeout(O,A)};O()}}},[o,e]);return d.useEffect(()=>{t&&t.length>0&&T()},[T,t]),s.jsx("ul",{className:"navbar-nav",children:(t||[]).map((n,m)=>s.jsx(d.Fragment,{children:n.isTitle?s.jsx("li",{className:"menu-title",children:n.label}):s.jsx(s.Fragment,{children:n.children?s.jsx(M,{item:n,toggleMenu:v,className:"nav-item",linkClassName:k("nav-link",C(n)),subMenuClassName:"nav sub-navbar-nav",activeMenuItems:a,openGroups:x}):s.jsx(I,{item:n,linkClassName:k("nav-link",C(n)),className:"nav-item"})})},n.key+m))})};export{X as default};
